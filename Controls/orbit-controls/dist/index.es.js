class t{constructor(t=0,s=0,i=0){this.x=t,this.y=s,this.z=i}set(t,s,i){return this.x=t,this.y=s,this.z=i,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subVectors(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this.z=t.z-s.z,this}fromArray(t,s){return void 0===s&&(s=0),this.x=t[s],this.y=t[s+1],this.z=t[s+2],this}setFromMatrixColumn(t,s){return this.fromArray(t.elements,4*s)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}clone(){return new t(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}crossVectors(t,s){var i=t.x,e=t.y,h=t.z,a=s.x,r=s.y,n=s.z;return this.x=e*n-h*r,this.y=h*a-i*n,this.z=i*r-e*a,this}divideScalar(t){return this.multiplyScalar(1/t)}normalize(){return this.divideScalar(this.length())}applyQuaternion(t){var s=this.x,i=this.y,e=this.z,h=t.x,a=t.y,r=t.z,n=t.w,o=n*s+a*e-r*i,l=n*i+r*s-h*e,u=n*e+h*i-a*s,c=-h*s-a*i-r*e;return this.x=o*n+c*-h+l*-r-u*-a,this.y=l*n+c*-a+u*-h-o*-r,this.z=u*n+c*-r+o*-a-l*-h,this}addScaledVector(t,s){return this.x+=t.x*s,this.y+=t.y*s,this.z+=t.z*s,this}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,s,i){var e=Math.sin(s)*t;return this.x=e*Math.sin(i),this.y=Math.cos(s)*t,this.z=e*Math.cos(i),this}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){var s=this.x-t.x,i=this.y-t.y,e=this.z-t.z;return s*s+i*i+e*e}}class s{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,s,i,e,h,a,r,n,o,l,u,c,m,d,p,y){var x=this.elements;return x[0]=t,x[4]=s,x[8]=i,x[12]=e,x[1]=h,x[5]=a,x[9]=r,x[13]=n,x[2]=o,x[6]=l,x[10]=u,x[14]=c,x[3]=m,x[7]=d,x[11]=p,x[15]=y,this}copy(t){var s=this.elements,i=t.elements;return s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],this}multiplyMatrices(t,s){var i=t.elements,e=s.elements,h=this.elements,a=i[0],r=i[4],n=i[8],o=i[12],l=i[1],u=i[5],c=i[9],m=i[13],d=i[2],p=i[6],y=i[10],x=i[14],_=i[3],f=i[7],z=i[11],g=i[15],w=e[0],M=e[4],v=e[8],b=e[12],C=e[1],D=e[5],S=e[9],E=e[13],A=e[2],k=e[6],F=e[10],R=e[14],q=e[3],P=e[7],O=e[11],I=e[15];return h[0]=a*w+r*C+n*A+o*q,h[4]=a*M+r*D+n*k+o*P,h[8]=a*v+r*S+n*F+o*O,h[12]=a*b+r*E+n*R+o*I,h[1]=l*w+u*C+c*A+m*q,h[5]=l*M+u*D+c*k+m*P,h[9]=l*v+u*S+c*F+m*O,h[13]=l*b+u*E+c*R+m*I,h[2]=d*w+p*C+y*A+x*q,h[6]=d*M+p*D+y*k+x*P,h[10]=d*v+p*S+y*F+x*O,h[14]=d*b+p*E+y*R+x*I,h[3]=_*w+f*C+z*A+g*q,h[7]=_*M+f*D+z*k+g*P,h[11]=_*v+f*S+z*F+g*O,h[15]=_*b+f*E+z*R+g*I,this}multiply(t){return this.multiplyMatrices(this,t)}makeTranslation(t,s,i){return this.set(1,0,0,t,0,1,0,s,0,0,1,i,0,0,0,1),this}makeScale(t,s,i){return this.set(t,0,0,0,0,s,0,0,0,0,i,0,0,0,0,1),this}makePerspective(t,s,i,e,h,a){var r=this.elements,n=2*h/(s-t),o=2*h/(i-e),l=(s+t)/(s-t),u=(i+e)/(i-e),c=-(a+h)/(a-h),m=-2*a*h/(a-h);return r[0]=n,r[4]=0,r[8]=l,r[12]=0,r[1]=0,r[5]=o,r[9]=u,r[13]=0,r[2]=0,r[6]=0,r[10]=c,r[14]=m,r[3]=0,r[7]=0,r[11]=-1,r[15]=0,this}makeOrthographic(t,s,i,e,h,a){var r=this.elements,n=1/(s-t),o=1/(i-e),l=1/(a-h),u=(s+t)*n,c=(i+e)*o,m=(a+h)*l;return r[0]=2*n,r[4]=0,r[8]=0,r[12]=-u,r[1]=0,r[5]=2*o,r[9]=0,r[13]=-c,r[2]=0,r[6]=0,r[10]=-2*l,r[14]=-m,r[3]=0,r[7]=0,r[11]=0,r[15]=1,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}getInverse(t){var s=this.elements,i=t.elements,e=i[0],h=i[1],a=i[2],r=i[3],n=i[4],o=i[5],l=i[6],u=i[7],c=i[8],m=i[9],d=i[10],p=i[11],y=i[12],x=i[13],_=i[14],f=i[15],z=m*_*u-x*d*u+x*l*p-o*_*p-m*l*f+o*d*f,g=y*d*u-c*_*u-y*l*p+n*_*p+c*l*f-n*d*f,w=c*x*u-y*m*u+y*o*p-n*x*p-c*o*f+n*m*f,M=y*m*l-c*x*l-y*o*d+n*x*d+c*o*_-n*m*_,v=e*z+h*g+a*w+r*M;if(0===v)return console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0"),this.identity();var b=1/v;return s[0]=z*b,s[1]=(x*d*r-m*_*r-x*a*p+h*_*p+m*a*f-h*d*f)*b,s[2]=(o*_*r-x*l*r+x*a*u-h*_*u-o*a*f+h*l*f)*b,s[3]=(m*l*r-o*d*r-m*a*u+h*d*u+o*a*p-h*l*p)*b,s[4]=g*b,s[5]=(c*_*r-y*d*r+y*a*p-e*_*p-c*a*f+e*d*f)*b,s[6]=(y*l*r-n*_*r-y*a*u+e*_*u+n*a*f-e*l*f)*b,s[7]=(n*d*r-c*l*r+c*a*u-e*d*u-n*a*p+e*l*p)*b,s[8]=w*b,s[9]=(y*m*r-c*x*r-y*h*p+e*x*p+c*h*f-e*m*f)*b,s[10]=(n*x*r-y*o*r+y*h*u-e*x*u-n*h*f+e*o*f)*b,s[11]=(c*o*r-n*m*r-c*h*u+e*m*u+n*h*p-e*o*p)*b,s[12]=M*b,s[13]=(c*x*a-y*m*a+y*h*d-e*x*d-c*h*_+e*m*_)*b,s[14]=(y*o*a-n*x*a-y*h*l+e*x*l+n*h*_-e*o*_)*b,s[15]=(n*m*a-c*o*a+c*h*l-e*m*l-n*h*d+e*o*d)*b,this}compose(t,s,i){var e=this.elements,h=s._x,a=s._y,r=s._z,n=s._w,o=h+h,l=a+a,u=r+r,c=h*o,m=h*l,d=h*u,p=a*l,y=a*u,x=r*u,_=n*o,f=n*l,z=n*u,g=i.x,w=i.y,M=i.z;return e[0]=(1-(p+x))*g,e[1]=(m+z)*g,e[2]=(d-f)*g,e[3]=0,e[4]=(m-z)*w,e[5]=(1-(c+x))*w,e[6]=(y+_)*w,e[7]=0,e[8]=(d+f)*M,e[9]=(y-_)*M,e[10]=(1-(c+p))*M,e[11]=0,e[12]=t.x,e[13]=t.y,e[14]=t.z,e[15]=1,this}decompose(i,e,h){var a=new t,r=new s,n=this.elements,o=a.set(n[0],n[1],n[2]).length(),l=a.set(n[4],n[5],n[6]).length(),u=a.set(n[8],n[9],n[10]).length();this.determinant()<0&&(o=-o),i.x=n[12],i.y=n[13],i.z=n[14],r.copy(this);var c=1/o,m=1/l,d=1/u;return r.elements[0]*=c,r.elements[1]*=c,r.elements[2]*=c,r.elements[4]*=m,r.elements[5]*=m,r.elements[6]*=m,r.elements[8]*=d,r.elements[9]*=d,r.elements[10]*=d,e.setFromRotationMatrix(r),h.x=o,h.y=l,h.z=u,this}determinant(){var t=this.elements,s=t[0],i=t[4],e=t[8],h=t[12],a=t[1],r=t[5],n=t[9],o=t[13],l=t[2],u=t[6],c=t[10],m=t[14];return t[3]*(+h*n*u-e*o*u-h*r*c+i*o*c+e*r*m-i*n*m)+t[7]*(+s*n*m-s*o*c+h*a*c-e*a*m+e*o*l-h*n*l)+t[11]*(+s*o*u-s*r*m-h*a*u+i*a*m+h*r*l-i*o*l)+t[15]*(-e*r*l-s*n*u+s*r*c+e*a*u-i*a*c+i*n*l)}clone(){return(new s).fromArray(this.elements)}fromArray(t,s=0){for(var i=0;i<16;i++)this.elements[i]=t[i+s];return this}extractRotation(s){var i=new t,e=this.elements,h=s.elements,a=1/i.setFromMatrixColumn(s,0).length(),r=1/i.setFromMatrixColumn(s,1).length(),n=1/i.setFromMatrixColumn(s,2).length();return e[0]=h[0]*a,e[1]=h[1]*a,e[2]=h[2]*a,e[4]=h[4]*r,e[5]=h[5]*r,e[6]=h[6]*r,e[8]=h[8]*n,e[9]=h[9]*n,e[10]=h[10]*n,this}lookAt(s,i,e){var h=new t,a=new t,r=new t,n=this.elements;return r.subVectors(s,i),0===r.lengthSq()&&(r.z=1),r.normalize(),h.crossVectors(e,r),0===h.lengthSq()&&(1===Math.abs(e.z)?r.x+=1e-4:r.z+=1e-4,r.normalize(),h.crossVectors(e,r)),h.normalize(),a.crossVectors(r,h),n[0]=h.x,n[4]=a.x,n[8]=r.x,n[1]=h.y,n[5]=a.y,n[9]=r.y,n[2]=h.z,n[6]=a.z,n[10]=r.z,this}}function i(t=0,s=0,i=0,e=1){this._x=t,this._y=s,this._z=i,this._w=void 0!==e?e:1}var e,h,a,r;Object.assign(i,{slerp:function(t,s,i,e){return i.copy(t).slerp(s,e)},slerpFlat:function(t,s,i,e,h,a,r){var n=i[e+0],o=i[e+1],l=i[e+2],u=i[e+3],c=h[a+0],m=h[a+1],d=h[a+2],p=h[a+3];if(u!==p||n!==c||o!==m||l!==d){var y=1-r,x=n*c+o*m+l*d+u*p,_=x>=0?1:-1,f=1-x*x;if(f>Number.EPSILON){var z=Math.sqrt(f),g=Math.atan2(z,x*_);y=Math.sin(y*g)/z,r=Math.sin(r*g)/z}var w=r*_;if(n=n*y+c*w,o=o*y+m*w,l=l*y+d*w,u=u*y+p*w,y===1-r){var M=1/Math.sqrt(n*n+o*o+l*l+u*u);n*=M,o*=M,l*=M,u*=M}}t[s]=n,t[s+1]=o,t[s+2]=l,t[s+3]=u}}),Object.defineProperties(i.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(i.prototype,{set:function(t,s,i,e){return this._x=t,this._y=s,this._z=i,this._w=e,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,s){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,e=t._y,h=t._z,a=t.order,r=Math.cos,n=Math.sin,o=r(i/2),l=r(e/2),u=r(h/2),c=n(i/2),m=n(e/2),d=n(h/2);return"XYZ"===a?(this._x=c*l*u+o*m*d,this._y=o*m*u-c*l*d,this._z=o*l*d+c*m*u,this._w=o*l*u-c*m*d):"YXZ"===a?(this._x=c*l*u+o*m*d,this._y=o*m*u-c*l*d,this._z=o*l*d-c*m*u,this._w=o*l*u+c*m*d):"ZXY"===a?(this._x=c*l*u-o*m*d,this._y=o*m*u+c*l*d,this._z=o*l*d+c*m*u,this._w=o*l*u-c*m*d):"ZYX"===a?(this._x=c*l*u-o*m*d,this._y=o*m*u+c*l*d,this._z=o*l*d-c*m*u,this._w=o*l*u+c*m*d):"YZX"===a?(this._x=c*l*u+o*m*d,this._y=o*m*u+c*l*d,this._z=o*l*d-c*m*u,this._w=o*l*u-c*m*d):"XZY"===a&&(this._x=c*l*u-o*m*d,this._y=o*m*u-c*l*d,this._z=o*l*d+c*m*u,this._w=o*l*u+c*m*d),!1!==s&&this.onChangeCallback(),this},setFromAxisAngle:function(t,s){var i=s/2,e=Math.sin(i);return this._x=t.x*e,this._y=t.y*e,this._z=t.z*e,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var s,i=t.elements,e=i[0],h=i[4],a=i[8],r=i[1],n=i[5],o=i[9],l=i[2],u=i[6],c=i[10],m=e+n+c;return m>0?(s=.5/Math.sqrt(m+1),this._w=.25/s,this._x=(u-o)*s,this._y=(a-l)*s,this._z=(r-h)*s):e>n&&e>c?(s=2*Math.sqrt(1+e-n-c),this._w=(u-o)/s,this._x=.25*s,this._y=(h+r)/s,this._z=(a+l)/s):n>c?(s=2*Math.sqrt(1+n-e-c),this._w=(a-l)/s,this._x=(h+r)/s,this._y=.25*s,this._z=(o+u)/s):(s=2*Math.sqrt(1+c-e-n),this._w=(r-h)/s,this._x=(a+l)/s,this._y=(o+u)/s,this._z=.25*s),this.onChangeCallback(),this},setFromUnitVectors:(h=new t,function(s,i){return void 0===h&&(h=new t),(e=s.dot(i)+1)<1e-6?(e=0,Math.abs(s.x)>Math.abs(s.z)?h.set(-s.y,s.x,0):h.set(0,-s.z,s.y)):h.crossVectors(s,i),this._x=h.x,this._y=h.y,this._z=h.z,this._w=e,this.normalize()}),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,s){return void 0!==s?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,s)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,s){var i=t._x,e=t._y,h=t._z,a=t._w,r=s._x,n=s._y,o=s._z,l=s._w;return this._x=i*l+a*r+e*o-h*n,this._y=e*l+a*n+h*r-i*o,this._z=h*l+a*o+i*n-e*r,this._w=a*l-i*r-e*n-h*o,this.onChangeCallback(),this},slerp:function(t,s){if(0===s)return this;if(1===s)return this.copy(t);var i=this._x,e=this._y,h=this._z,a=this._w,r=a*t._w+i*t._x+e*t._y+h*t._z;if(r<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,r=-r):this.copy(t),r>=1)return this._w=a,this._x=i,this._y=e,this._z=h,this;var n=Math.sqrt(1-r*r);if(Math.abs(n)<.001)return this._w=.5*(a+this._w),this._x=.5*(i+this._x),this._y=.5*(e+this._y),this._z=.5*(h+this._z),this;var o=Math.atan2(n,r),l=Math.sin((1-s)*o)/n,u=Math.sin(s*o)/n;return this._w=a*l+this._w*u,this._x=i*l+this._x*u,this._y=e*l+this._y*u,this._z=h*l+this._z*u,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,s){return void 0===s&&(s=0),this._x=t[s],this._y=t[s+1],this._z=t[s+2],this._w=t[s+3],this.onChangeCallback(),this},toArray:function(t,s){return void 0===t&&(t=[]),void 0===s&&(s=0),t[s]=this._x,t[s+1]=this._y,t[s+2]=this._z,t[s+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}});(r=a||(a={}))[r.FRONT=0]="FRONT",r[r.BACK=1]="BACK",r[r.DOUBLE=2]="DOUBLE";class n{constructor(t,s=1,i=1){if(this.state=new Proxy({needsUpdate:!1,version:0},{set:(t,s,i,e)=>{let h=Reflect.set(t,s,i,e);return"needsUpdate"===s&&!0===i&&this.version++,h}}),this.version=0,this.imageLoadedCount=0,this.image=null,this.images=[],t instanceof Array)this.imageCount=t.length,t.forEach(t=>{let s=new Image;s.onload=()=>{this.loadedCallback(),s.onload=null},s.src=t,this.images.push(s)});else if(t){let s=new Image;s.onload=()=>{this.loadedCallback(),s.onload=null},s.src=t,this.image=s,this.imageCount=1}this.format=s,this.type=i,this.needsUpdate=!1,this.glTexture=null}loadedCallback(){this.imageLoadedCount+=1,this.imageLoadedCount==this.imageCount&&(this.state.needsUpdate=!0)}clone(){return new n(void 0).copy(this)}copy(t){return this.image=t.image,this.format=t.format,this.type=t.type,this}}new n;var o;class l extends class{constructor(){this.changed=!1,this.matrix=new s,this.matrixWorld=new s,this.position=new Proxy(new t,{set:(t,s,i,e)=>{let h=Reflect.set(t,s,i,e);return this.updateMatrixWorld(!0),h}}),this.quaternion=new Proxy(new i,{set:(t,s,i,e)=>{let h=Reflect.set(t,s,i,e);return this.updateMatrixWorld(!0),h}}),this.scale=new Proxy(new t(1,1,1),{set:(t,s,i,e)=>{let h=Reflect.set(t,s,i,e);return this.updateMatrixWorld(!0),h}}),this.parent=null,this.children=[],this.matrixAutoUpdate=!0}applyMatrix(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)}updateMatrix(){this.changed=!0,this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var s=this.children,i=0,e=s.length;i<e;i++)s[i].updateMatrixWorld(t)}rotateOnAxis(t,s){var e=new i;return e.setFromAxisAngle(t,s),this.quaternion.multiply(e),this}rotateOnWorldAxis(t,s){var e=new i;return e.setFromAxisAngle(t,s),this.quaternion.premultiply(e),this}rotateX(s){var i=new t(1,0,0);return this.rotateOnAxis(i,s)}rotateY(s){var i=new t(0,1,0);return this.rotateOnAxis(i,s)}rotateZ(s){var i=new t(0,0,1);return this.rotateOnAxis(i,s)}add(t){return t&&(t.parent=this,this.children.push(t)),this}traverse(t){t(this);for(var s=this.children,i=0,e=s.length;i<e;i++)s[i].traverse(t)}}{constructor(){super(),this.up=new t(0,1,0),this.projectionMatrix=new s,this.matrixWorldInverse=new s,this.target=new t}lookTarget(t){t=t||this.target;var i=new s;i.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix(i)}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.getInverse(this.matrixWorld)}}class u extends l{constructor(t,s,i,e){super(),this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==e?e:2e3,this.focus=10,this.aspect=void 0!==s?s:1,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}updateProjectionMatrix(){var t=this.near,s=t*Math.tan(Math.PI/180*.5*this.fov)/this.zoom,i=2*s,e=this.aspect*i,h=-.5*e,a=this.filmOffset;0!==a&&(h+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(h,h+e,s,s-i,t,this.far)}}class c{constructor(t=0,s=0){this.x=t,this.y=s}set(t,s){return this.x=t,this.y=s,this}add(t){return this.x+=t.x,this.y+=t.y,this}sub(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}clone(){return new c(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}equals(t){return t.x===this.x&&t.y===this.y}subVectors(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this}}!function(t){t[t.PERSPECTIVE=0]="PERSPECTIVE",t[t.ORTHOGRAPHIC=1]="ORTHOGRAPHIC"}(o||(o={}));class m extends l{constructor(t,s,i,e,h,a){super(),this.zoom=1,this.left=t,this.right=s,this.top=i,this.bottom=e,this.near=void 0!==h?h:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}updateProjectionMatrix(){var t=(this.right-this.left)/(2*this.zoom),s=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,e=(this.top+this.bottom)/2,h=i-t,a=i+t,r=e+s,n=e-s;this.projectionMatrix.makeOrthographic(h,a,r,n,this.near,this.far)}}function d(t=1,s=0,i=0){this.radius=t,this.phi=s,this.theta=i}Object.assign(d.prototype,{set:function(t,s,i){return this.radius=t,this.phi=s,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,s,i){var e,h,a;return this.radius=Math.sqrt(t*t+s*s+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos((e=s/this.radius,h=-1,a=1,Math.max(h,Math.min(a,e))))),this}});let p=0,y=1,x=2,_=-1,f=0,z=1;export default class{constructor(s,e){this.camera=s,this.domElement=e,this.enabled=!0,this.target=new t,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!0,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=.3,this.autoRotate=!1,this.autoRotateSpeed=2,this.mouseButtons={LEFT:p,MIDDLE:y,RIGHT:x},this.state=_,this.spherical=new d,this.sphericalDelta=new d,this.scale=1,this.panOffset=new t,this.zoomChanged=!1,this.rotateStart=new c,this.rotateEnd=new c,this.rotateDelta=new c,this.dollyStart=new c,this.dollyEnd=new c,this.dollyDelta=new c,this.offset=new t,this.quat=(new i).setFromUnitVectors(this.camera.up,new t(0,1,0)),this.quatInverse=this.quat.clone().inverse(),this.lastPosition=new t,this.lastQuaternion=new i,this.onMouseDown=t=>{if(!1!==this.enabled){switch(t.preventDefault(),t.button){case 0:switch(this.mouseButtons.LEFT){case p:if(t.ctrlKey||t.metaKey||t.shiftKey);else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(t),this.state=f}break;default:this.state=_}break;case 1:switch(this.mouseButtons.MIDDLE){case y:if(!1===this.enableZoom)return;this.handleMouseDownDolly(t),this.state=z;break;default:this.state=_}break;case 2:switch(this.mouseButtons.RIGHT){case p:if(!1===this.enableRotate)return;this.handleMouseDownRotate(t),this.state=f;break;default:this.state=_}}this.state!==_&&(document.addEventListener("mousemove",this.onMouseMove,!1),document.addEventListener("mouseup",this.onMouseUp,!1))}},this.onMouseMove=t=>{if(!1!==this.enabled)switch(t.preventDefault(),this.state){case f:if(!1===this.enableRotate)return;this.handleMouseMoveRotate(t);break;case z:if(!1===this.enableZoom)return;this.handleMouseMoveDolly(t)}},this.onMouseUp=t=>{!1!==this.enabled&&(document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),this.state=_)},this.onMouseWheel=t=>{!1===this.enabled||!1===this.enableZoom||this.state!==_&&this.state!==f||(t.preventDefault(),t.stopPropagation(),this.handleMouseWheel(t))},this.domElement.addEventListener("mousedown",this.onMouseDown,!1),this.domElement.addEventListener("wheel",this.onMouseWheel,!1)}handleMouseDownRotate(t){this.rotateStart.set(t.clientX,t.clientY)}handleMouseDownDolly(t){this.dollyStart.set(t.clientX,t.clientY)}handleMouseMoveRotate(t){this.rotateEnd.set(t.clientX,t.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);var s=this.domElement;this.rotateLeft(2*Math.PI*this.rotateDelta.x/s.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/s.clientHeight),this.rotateStart.copy(this.rotateEnd)}handleMouseMoveDolly(t){this.dollyEnd.set(t.clientX,t.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyIn(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyOut(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd)}handleMouseWheel(t){t.deltaY<0?this.dollyOut(this.getZoomScale()):t.deltaY>0&&this.dollyIn(this.getZoomScale())}rotateLeft(t){this.sphericalDelta.theta-=t}rotateUp(t){this.sphericalDelta.phi-=t}dollyIn(t){this.camera instanceof u?this.scale/=t:this.camera instanceof m?(this.camera.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.camera.zoom*t)),this.camera.updateProjectionMatrix(),this.zoomChanged=!0):this.enableZoom=!1}dollyOut(t){this.camera instanceof u?this.scale*=t:this.camera instanceof m?(this.camera.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.camera.zoom/t)),this.camera.updateProjectionMatrix(),this.zoomChanged=!0):this.enableZoom=!1}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}update(){var t=this.camera.position;return this.offset.copy(t).sub(this.target),this.offset.applyQuaternion(this.quat),this.spherical.setFromVector3(this.offset),this.autoRotate&&this.state===_&&this.rotateLeft(this.getAutoRotationAngle()),this.enableDamping?(this.spherical.theta+=this.sphericalDelta.theta*this.dampingFactor,this.spherical.phi+=this.sphericalDelta.phi*this.dampingFactor):(this.spherical.theta+=this.sphericalDelta.theta,this.spherical.phi+=this.sphericalDelta.phi),this.spherical.theta=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,this.spherical.theta)),this.spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this.spherical.phi)),this.spherical.makeSafe(),this.spherical.radius*=this.scale,this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius)),!0===this.enableDamping?this.target.addScaledVector(this.panOffset,this.dampingFactor):this.target.add(this.panOffset),this.offset.setFromSpherical(this.spherical),this.offset.applyQuaternion(this.quatInverse),t.copy(this.target).add(this.offset),this.camera.lookTarget(this.target),!0===this.enableDamping?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor,this.panOffset.multiplyScalar(1-this.dampingFactor)):(this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0)),this.scale=1,!!(this.zoomChanged||this.lastPosition.distanceToSquared(this.camera.position)>1e-6||8*(1-this.lastQuaternion.dot(this.camera.quaternion))>1e-6)&&(this.lastPosition.copy(this.camera.position),this.lastQuaternion.copy(this.camera.quaternion),this.zoomChanged=!1,!0)}}
//# sourceMappingURL=index.es.js.map
