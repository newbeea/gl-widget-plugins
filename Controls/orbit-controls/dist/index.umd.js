!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@gl-widget/gl-widget")):"function"==typeof define&&define.amd?define(["@gl-widget/gl-widget"],e):(t=t||self)["orbit-controls"]=e(t.GLWidget)}(this,(function(t){"use strict";function e(t=1,e=0,i=0){this.radius=t,this.phi=e,this.theta=i}Object.assign(e.prototype,{set:function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,i){var s,a,h;return this.radius=Math.sqrt(t*t+e*e+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos((s=e/this.radius,a=-1,h=1,Math.max(a,Math.min(h,s))))),this}});let i=0,s=1,a=2,h=-1,o=0,n=1;return class{constructor(r,l){this.camera=r,this.domElement=l,this.enabled=!0,this.target=new t.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!0,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=.3,this.autoRotate=!1,this.autoRotateSpeed=2,this.mouseButtons={LEFT:i,MIDDLE:s,RIGHT:a},this.state=h,this.spherical=new e,this.sphericalDelta=new e,this.scale=1,this.panOffset=new t.Vector3,this.zoomChanged=!1,this.rotateStart=new t.Vector2,this.rotateEnd=new t.Vector2,this.rotateDelta=new t.Vector2,this.dollyStart=new t.Vector2,this.dollyEnd=new t.Vector2,this.dollyDelta=new t.Vector2,this.offset=new t.Vector3,this.quat=(new t.Quaternion).setFromUnitVectors(this.camera.up,new t.Vector3(0,1,0)),this.quatInverse=this.quat.clone().inverse(),this.lastPosition=new t.Vector3,this.lastQuaternion=new t.Quaternion,this.onMouseDown=t=>{if(!1!==this.enabled){switch(t.preventDefault(),t.button){case 0:switch(this.mouseButtons.LEFT){case i:if(t.ctrlKey||t.metaKey||t.shiftKey);else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(t),this.state=o}break;default:this.state=h}break;case 1:switch(this.mouseButtons.MIDDLE){case s:if(!1===this.enableZoom)return;this.handleMouseDownDolly(t),this.state=n;break;default:this.state=h}break;case 2:switch(this.mouseButtons.RIGHT){case i:if(!1===this.enableRotate)return;this.handleMouseDownRotate(t),this.state=o;break;default:this.state=h}}this.state!==h&&(document.addEventListener("mousemove",this.onMouseMove,!1),document.addEventListener("mouseup",this.onMouseUp,!1))}},this.onMouseMove=t=>{if(!1!==this.enabled)switch(t.preventDefault(),this.state){case o:if(!1===this.enableRotate)return;this.handleMouseMoveRotate(t);break;case n:if(!1===this.enableZoom)return;this.handleMouseMoveDolly(t)}},this.onMouseUp=t=>{!1!==this.enabled&&(document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),this.state=h)},this.onMouseWheel=t=>{!1===this.enabled||!1===this.enableZoom||this.state!==h&&this.state!==o||(t.preventDefault(),t.stopPropagation(),this.handleMouseWheel(t))},this.domElement.addEventListener("mousedown",this.onMouseDown,!1),this.domElement.addEventListener("wheel",this.onMouseWheel,!1)}handleMouseDownRotate(t){this.rotateStart.set(t.clientX,t.clientY)}handleMouseDownDolly(t){this.dollyStart.set(t.clientX,t.clientY)}handleMouseMoveRotate(t){this.rotateEnd.set(t.clientX,t.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);var e=this.domElement;this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight),this.rotateStart.copy(this.rotateEnd)}handleMouseMoveDolly(t){this.dollyEnd.set(t.clientX,t.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyIn(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyOut(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd)}handleMouseWheel(t){t.deltaY<0?this.dollyOut(this.getZoomScale()):t.deltaY>0&&this.dollyIn(this.getZoomScale()),this.update()}rotateLeft(t){this.sphericalDelta.theta-=t}rotateUp(t){this.sphericalDelta.phi-=t}dollyIn(t){this.camera.isPerspective?this.scale/=t:this.camera.isOrthographic?(this.camera.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.camera.zoom*t)),this.camera.updateProjectionMatrix(),this.zoomChanged=!0):this.enableZoom=!1}dollyOut(t){this.camera.isPerspective?this.scale*=t:this.camera.isOrthographic?(this.camera.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.camera.zoom/t)),this.camera.updateProjectionMatrix(),this.zoomChanged=!0):this.enableZoom=!1}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}update(){var t=this.camera.position;return this.offset.copy(t).sub(this.target),this.offset.applyQuaternion(this.quat),this.spherical.setFromVector3(this.offset),this.autoRotate&&this.state===h&&this.rotateLeft(this.getAutoRotationAngle()),this.enableDamping?(this.spherical.theta+=this.sphericalDelta.theta*this.dampingFactor,this.spherical.phi+=this.sphericalDelta.phi*this.dampingFactor):(this.spherical.theta+=this.sphericalDelta.theta,this.spherical.phi+=this.sphericalDelta.phi),this.spherical.theta=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,this.spherical.theta)),this.spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this.spherical.phi)),this.spherical.makeSafe(),this.spherical.radius*=this.scale,this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius)),!0===this.enableDamping?this.target.addScaledVector(this.panOffset,this.dampingFactor):this.target.add(this.panOffset),this.offset.setFromSpherical(this.spherical),this.offset.applyQuaternion(this.quatInverse),t.copy(this.target).add(this.offset),this.camera.lookTarget(this.target),!0===this.enableDamping?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor,this.panOffset.multiplyScalar(1-this.dampingFactor)):(this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0)),this.scale=1,!!(this.zoomChanged||this.lastPosition.distanceToSquared(this.camera.position)>1e-6||8*(1-this.lastQuaternion.dot(this.camera.quaternion))>1e-6)&&(this.lastPosition.copy(this.camera.position),this.lastQuaternion.copy(this.camera.quaternion),this.zoomChanged=!1,!0)}}}));
//# sourceMappingURL=index.umd.js.map
