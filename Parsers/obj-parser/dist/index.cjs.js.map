{"version":3,"file":"index.cjs.js","sources":["../node_modules/parse-wavefront-obj/index.js"],"sourcesContent":["\n\nfunction parse(str) {\n  if(typeof buf !== 'string') {\n    str = str.toString();\n  }\n\n  var lines = str.trim().split('\\n');\n\n  var positions = [];\n  var cells = [];\n  var vertexUVs = [];\n  var vertexNormals = [];\n  var faceUVs = [];\n  var faceNormals = [];\n  var name = null;\n\n  for(var i=0; i<lines.length; i++) {\n    var line = lines[i];\n\n    if(line[0] === '#') continue;\n\n    var parts = line\n      .trim()\n      .replace(/ +/g, ' ')\n      .split(' ');\n\n    switch(parts[0]) {\n      case 'o':\n        name = parts.slice(1).join(' ');\n        break;\n      case 'v':\n        var position = parts.slice(1).map(Number).slice(0, 3);\n        positions.push(position);\n        break;\n      case 'vt':\n        var uv = parts.slice(1).map(Number);\n        vertexUVs.push(uv);\n        break;\n      case 'vn':\n        var normal = parts.slice(1).map(Number);\n        vertexNormals.push(normal);\n        break;\n      case 'f':\n        var positionIndices = [];\n        var uvIndices = [];\n        var normalIndices = [];\n\n        parts\n          .slice(1)\n          .forEach(function(part) {\n            var indices = part\n              .split('/')\n              .map(function(index) {\n                if(index === '') {\n                  return NaN;\n                }\n                return Number(index);\n              })\n\n            positionIndices.push(convertIndex(indices[0], positions.length));\n\n            if(indices.length > 1) {\n              if(!isNaN(indices[1])) {\n                uvIndices.push(convertIndex(indices[1], vertexUVs.length));\n              }\n              if(!isNaN(indices[2])) {\n                normalIndices.push(convertIndex(indices[2], vertexNormals.length));\n              }\n            }\n\n          });\n\n          cells.push(positionIndices);\n\n          if(uvIndices.length > 0) {\n            faceUVs.push(uvIndices);\n          }\n          if(normalIndices.length > 0) {\n            faceNormals.push(normalIndices);\n          }\n          \n        break;\n      default:\n        // skip\n    }\n\n  }\n\n  var mesh = {\n    positions: positions,\n    cells: cells\n  };\n\n  if(vertexUVs.length > 0) {\n    mesh.vertexUVs = vertexUVs;\n  }\n\n  if(faceUVs.length > 0) { \n    mesh.faceUVs = faceUVs;\n  }\n\n  if(vertexNormals.length > 0) {\n    mesh.vertexNormals = vertexNormals;\n  }\n\n  if(faceNormals.length > 0) {\n    mesh.faceNormals = faceNormals;\n  }\n\n  if(name !== null) {\n    mesh.name = name;\n  }\n\n  return mesh;\n}\n\nfunction convertIndex(objIndex, arrayLength) {\n  return objIndex > 0 ? objIndex - 1 : objIndex + arrayLength;\n}\n\nmodule.exports = parse;\n"],"names":["convertIndex","objIndex","arrayLength","module","str","buf","toString","lines","trim","split","positions","cells","vertexUVs","vertexNormals","faceUVs","faceNormals","name","i","length","line","parts","replace","slice","join","position","map","Number","push","uv","normal","positionIndices","uvIndices","normalIndices","forEach","part","indices","index","NaN","isNaN","mesh"],"mappings":"wiRAqHA,SAASA,EAAaC,EAAUC,UACvBD,EAAW,EAAIA,EAAW,EAAIA,EAAWC,+FAGlDC,MAvHA,SAAeC,GACK,iBAARC,MACRD,EAAMA,EAAIE,oBAGRC,EAAQH,EAAII,OAAOC,MAAM,MAEzBC,EAAY,GACZC,EAAQ,GACRC,EAAY,GACZC,EAAgB,GAChBC,EAAU,GACVC,EAAc,GACdC,EAAO,KAEHC,EAAE,EAAGA,EAAEV,EAAMW,OAAQD,IAAK,KAC5BE,EAAOZ,EAAMU,MAEF,MAAZE,EAAK,QAEJC,EAAQD,EACTX,OACAa,QAAQ,MAAO,KACfZ,MAAM,YAEFW,EAAM,QACN,IACHJ,EAAOI,EAAME,MAAM,GAAGC,KAAK,eAExB,QACCC,EAAWJ,EAAME,MAAM,GAAGG,IAAIC,QAAQJ,MAAM,EAAG,GACnDZ,EAAUiB,KAAKH,aAEZ,SACCI,EAAKR,EAAME,MAAM,GAAGG,IAAIC,QAC5Bd,EAAUe,KAAKC,aAEZ,SACCC,EAAST,EAAME,MAAM,GAAGG,IAAIC,QAChCb,EAAcc,KAAKE,aAEhB,QACCC,EAAkB,GAClBC,EAAY,GACZC,EAAgB,GAEpBZ,EACGE,MAAM,GACNW,SAAQ,SAASC,OACZC,EAAUD,EACXzB,MAAM,KACNgB,KAAI,SAASW,SACC,KAAVA,EACMC,IAEFX,OAAOU,MAGlBN,EAAgBH,KAAK3B,EAAamC,EAAQ,GAAIzB,EAAUQ,SAErDiB,EAAQjB,OAAS,IACdoB,MAAMH,EAAQ,KAChBJ,EAAUJ,KAAK3B,EAAamC,EAAQ,GAAIvB,EAAUM,SAEhDoB,MAAMH,EAAQ,KAChBH,EAAcL,KAAK3B,EAAamC,EAAQ,GAAItB,EAAcK,aAMhEP,EAAMgB,KAAKG,GAERC,EAAUb,OAAS,GACpBJ,EAAQa,KAAKI,GAEZC,EAAcd,OAAS,GACxBH,EAAYY,KAAKK,SAUvBO,EAAO,CACT7B,UAAWA,EACXC,MAAOA,UAGNC,EAAUM,OAAS,IACpBqB,EAAK3B,UAAYA,GAGhBE,EAAQI,OAAS,IAClBqB,EAAKzB,QAAUA,GAGdD,EAAcK,OAAS,IACxBqB,EAAK1B,cAAgBA,GAGpBE,EAAYG,OAAS,IACtBqB,EAAKxB,YAAcA,GAGT,OAATC,IACDuB,EAAKvB,KAAOA,GAGPuB"}